/* File generated by Đức's ClasHStamP */
#define __CarBody_INTERNAL__
#include "CommonInclude.h"
#include "CarBody.h"
#include "ObjsBuilder.h"                                        
#include "MotorRotor.h"                                         
/** @public @memberof CarBody */
void CarBody_moveRight(
    CarBody* pCarBody
){
} /* CarBody_moveRight */

/** @public @memberof CarBody */
void CarBody_moveLeft(
    CarBody* pCarBody
){
} /* CarBody_moveLeft */

const TCHAR* CarBodyEvent_toString( CarBody_EVENT value ){
    switch( value ){
    case CarBody_E_PWR_BTN: return _T( "E_PWR_BTN" );
    case CarBody_E_WIPER_LEVER: return _T( "E_WIPER_LEVER" );
    case CarBody_TICK: return _T( "TICK" );
    default: return _T( "CarBody_UNKNOWN" );
    }
}
static void PowerOn_Region1_BgnTrans( CarBody *pPowerOn, PowerOn_Region1* pStm, uint64_t targetState, uint64_t initState );
static void PowerOn_Region1_EndTrans( CarBody *pPowerOn, PowerOn_Region1* pStm );
static BOOL PowerOn_Region1_Reset( CarBody* pPowerOn, PowerOn_Region1* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint );
static BOOL PowerOn_Region1_Abort( CarBody* pPowerOn, PowerOn_Region1* pStm );
static BOOL PowerOn_Region1_EventProc( CarBody* pPowerOn, PowerOn_Region1* pStm, CarBody_EVENT nEventId, void* pEventParams );
static BOOL PowerOn_Region1_RunToCompletion( CarBody* pPowerOn, PowerOn_Region1* pStm );
static void PowerOn_Region1_WipingCCW_Entry( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, PowerOn_Region1_WipingCCW ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	546	336	145	64	-146	-80	1056	518" );
    }
}
static BOOL PowerOn_Region1_WipingCCW_EventProc( CarBody* pCarBody, PowerOn_Region1* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = PowerOn_Region1_WipingCCW;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	546	336	145	64	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_TICK:{
        MotorRotor_rotateCCW(leftWiperMotor);
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult;
}
static void PowerOn_Region1_WipingCCW_Exit( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, PowerOn_Region1_WipingCCW ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	546	336	145	64	-146	-80	1056	518" );
    }
}
static void PowerOn_Region1_WipingCW_Entry( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, PowerOn_Region1_WipingCW ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	546	242	145	64	-146	-80	1056	518" );
    }
}
static BOOL PowerOn_Region1_WipingCW_EventProc( CarBody* pCarBody, PowerOn_Region1* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = PowerOn_Region1_WipingCW;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	546	242	145	64	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_TICK:{
        MotorRotor_rotateCW(leftWiperMotor);
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult;
}
static void PowerOn_Region1_WipingCW_Exit( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, PowerOn_Region1_WipingCW ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	546	242	145	64	-146	-80	1056	518" );
    }
}
static void PowerOn_Region1_WiperIdle_Entry( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, PowerOn_Region1_WiperIdle ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	546	143	152	64	-146	-80	1056	518" );
    }
}
static BOOL PowerOn_Region1_WiperIdle_EventProc( CarBody* pCarBody, PowerOn_Region1* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = PowerOn_Region1_WiperIdle;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	546	143	152	64	-146	-80	1056	518" );
    return bResult;
}
static void PowerOn_Region1_WiperIdle_Exit( CarBody* pCarBody, PowerOn_Region1* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, PowerOn_Region1_WiperIdle ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	546	143	152	64	-146	-80	1056	518" );
    }
}
static void PowerOn_Region1_EndTrans( CarBody *pCarBody, PowerOn_Region1* pStm ){
    pStm->base.nCurrentState = pStm->base.nTargetState;
    pStm->base.bIsExternTrans = FALSE;
    switch( pStm->base.nCurrentState ){
    case PowerOn_Region1_WipingCCW:PowerOn_Region1_WipingCCW_Entry( pCarBody, pStm ); break;
    case PowerOn_Region1_WipingCW:PowerOn_Region1_WipingCW_Entry( pCarBody, pStm ); break;
    case PowerOn_Region1_WiperIdle:PowerOn_Region1_WiperIdle_Entry( pCarBody, pStm ); break;
    default: break;
    }
}
static void PowerOn_Region1_BgnTrans( CarBody *pCarBody, PowerOn_Region1* pStm, uint64_t targetState, uint64_t initState ){
    pStm->base.nTargetState = targetState;
    pStm->base.nPseudostate = targetState;
    if( initState ){
        pStm->base.nPseudostate = initState;
    }
    switch( pStm->base.nCurrentState ){
    case PowerOn_Region1_WipingCCW:PowerOn_Region1_WipingCCW_Exit( pCarBody, pStm ); break;
    case PowerOn_Region1_WipingCW:PowerOn_Region1_WipingCW_Exit( pCarBody, pStm ); break;
    case PowerOn_Region1_WiperIdle:PowerOn_Region1_WiperIdle_Exit( pCarBody, pStm ); break;
    default: break;
    }
}
static BOOL PowerOn_Region1_StateDefaultTrans( CarBody* pCarBody, PowerOn_Region1* pStm ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = pStm->base.nCurrentState;
    pStm->base.nLCAState = STATE_UNDEF;
    do{   if( pStm->base.nPseudostate == PowerOn_Region1_WipingCCW ){
        if (MotorRotor_isRotMin( leftWiperMotor )) {
            if (CarBody_IsIn( pCarBody, CarStm_PowerOffWait )) {
                CarBody_Reset( pCarBody, CarStm_PowerOff );
            } else {
                PowerOn_Region1_BgnTrans( pCarBody, pStm, PowerOn_Region1_WiperIdle, STATE_UNDEF );
                PowerOn_Region1_EndTrans( pCarBody, pStm );
                bResult = TRUE;
            }
        }
    }else if( pStm->base.nPseudostate == PowerOn_Region1_InitialPowerOnRegion1 ){
        PowerOn_Region1_BgnTrans( pCarBody, pStm, PowerOn_Region1_WiperIdle, STATE_UNDEF );
        PowerOn_Region1_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nPseudostate == PowerOn_Region1_WipingCW ){
        if (MotorRotor_isRotMax( leftWiperMotor )) {
            PowerOn_Region1_BgnTrans( pCarBody, pStm, PowerOn_Region1_WipingCCW, STATE_UNDEF );
            PowerOn_Region1_EndTrans( pCarBody, pStm );
            bResult = TRUE;
        }
    }else if( pStm->base.nPseudostate == PowerOn_Region1_WiperIdle ){
        if (CarBody_IsIn( pCarBody, CarStm_WiperOn )) {
            PowerOn_Region1_BgnTrans( pCarBody, pStm, PowerOn_Region1_WipingCW, STATE_UNDEF );
            PowerOn_Region1_EndTrans( pCarBody, pStm );
            bResult = TRUE;
        }
    }else if( pStm->base.nCurrentState != pStm->base.nPseudostate && IS_IN(pStm->base.nPseudostate, PowerOn_Region1_PowerOn) ){
        PowerOn_Region1_BgnTrans( pCarBody, pStm, pStm->base.nPseudostate, STATE_UNDEF );
        PowerOn_Region1_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else{
    }   }while( FALSE );
    return bResult;
}
static BOOL PowerOn_Region1_RunToCompletion( CarBody* pCarBody, PowerOn_Region1* pStm ){
    BOOL bResult;
    do{
        bResult = PowerOn_Region1_StateDefaultTrans( pCarBody, pStm );
    } while ( bResult );
    return bResult;
}
static int PowerOn_Region1_IsFinished(PowerOn_Region1* pPowerOn_Region1){
    return pPowerOn_Region1->base.nCurrentState == PowerOn_Region1_PowerOn && pPowerOn_Region1->base.nCurrentState == pPowerOn_Region1->base.nPseudostate;
}
static BOOL PowerOn_Region1_Reset( CarBody* pCarBody, PowerOn_Region1* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint ) {
    pStm->base.pParentStm = pParentStm;
    if( nEntryPoint == NULL ){
        if( PowerOn_Region1_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = PowerOn_Region1_InitialPowerOnRegion1;
        }
        return FALSE;
    }else{
    if( !IS_IN( nEntryPoint, PowerOn_Region1_PowerOn ) ){ return FALSE; }
        if( PowerOn_Region1_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = nEntryPoint;
            return FALSE;
        }else{
            pStm->base.nPseudostate = nEntryPoint;
        }
    }
    return TRUE;
}
static BOOL PowerOn_Region1_EventProc( CarBody* pCarBody, PowerOn_Region1* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nLCAState = STATE_UNDEF;
    switch( pStm->base.nCurrentState ){
    case PowerOn_Region1_WipingCCW:             bResult |= PowerOn_Region1_WipingCCW_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case PowerOn_Region1_WipingCW:              bResult |= PowerOn_Region1_WipingCW_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case PowerOn_Region1_WiperIdle:             bResult |= PowerOn_Region1_WiperIdle_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    default: break;
    }
    PowerOn_Region1_RunToCompletion( pCarBody, pStm );
    return bResult;
}
static BOOL PowerOn_Region1_IsIn( PowerOn_Region1* pStm, uint64_t nCompositeState ) {
    if( IS_IN( pStm->base.nCurrentState, nCompositeState ) ){ return TRUE; }
    return FALSE;
}
static BOOL PowerOn_Region1_Abort( CarBody* pCarBody, PowerOn_Region1* pStm ) {
    pStm->base.nSourceState = PowerOn_Region1_PowerOn;
    PowerOn_Region1_BgnTrans( pCarBody, pStm, PowerOn_Region1_PowerOn, STATE_UNDEF );
    PowerOn_Region1_EndTrans( pCarBody, pStm );
    return TRUE;
}
static void WiperTestStm_BgnTrans( CarBody *pWiperTestTop, WiperTestStm* pStm, uint64_t targetState, uint64_t initState );
static void WiperTestStm_EndTrans( CarBody *pWiperTestTop, WiperTestStm* pStm );
static BOOL WiperTestStm_Reset( CarBody* pWiperTestTop, WiperTestStm* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint );
static BOOL WiperTestStm_Abort( CarBody* pWiperTestTop, WiperTestStm* pStm );
static BOOL WiperTestStm_EventProc( CarBody* pWiperTestTop, WiperTestStm* pStm, CarBody_EVENT nEventId, void* pEventParams );
static BOOL WiperTestStm_RunToCompletion( CarBody* pWiperTestTop, WiperTestStm* pStm );
static void WiperTestStm_State0_Entry( CarBody* pCarBody, WiperTestStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, WiperTestStm_State0 ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/WiperTestStm	106	103	50	30	-27	0	393	260" );
    }
}
static BOOL WiperTestStm_State0_EventProc( CarBody* pCarBody, WiperTestStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = WiperTestStm_State0;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/WiperTestStm	106	103	50	30	-27	0	393	260" );
    return bResult;
}
static void WiperTestStm_State0_Exit( CarBody* pCarBody, WiperTestStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, WiperTestStm_State0 ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/WiperTestStm	106	103	50	30	-27	0	393	260" );
    }
}
static void WiperTestStm_EndTrans( CarBody *pCarBody, WiperTestStm* pStm ){
    pStm->base.nCurrentState = pStm->base.nTargetState;
    pStm->base.bIsExternTrans = FALSE;
    switch( pStm->base.nCurrentState ){
    case WiperTestStm_State0:   WiperTestStm_State0_Entry( pCarBody, pStm ); break;
    default: break;
    }
}
static void WiperTestStm_BgnTrans( CarBody *pCarBody, WiperTestStm* pStm, uint64_t targetState, uint64_t initState ){
    pStm->base.nTargetState = targetState;
    pStm->base.nPseudostate = targetState;
    if( initState ){
        pStm->base.nPseudostate = initState;
    }
    switch( pStm->base.nCurrentState ){
    case WiperTestStm_State0:   WiperTestStm_State0_Exit( pCarBody, pStm ); break;
    default: break;
    }
}
static BOOL WiperTestStm_StateDefaultTrans( CarBody* pCarBody, WiperTestStm* pStm ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = pStm->base.nCurrentState;
    pStm->base.nLCAState = STATE_UNDEF;
    do{   if( pStm->base.nPseudostate == WiperTestStm_State0 ){
        WiperTestStm_BgnTrans( pCarBody, pStm, WiperTestStm_WiperTestTop, STATE_UNDEF );
        pStm->base.pParentStm->nPseudostate = WiperTestStm_ExitPoint0;
        WiperTestStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nPseudostate == WiperTestStm_EntryPoint0 ){
        WiperTestStm_BgnTrans( pCarBody, pStm, WiperTestStm_State0, STATE_UNDEF );
        WiperTestStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nPseudostate == WiperTestStm_InitialWiperTestStm ){
        WiperTestStm_BgnTrans( pCarBody, pStm, WiperTestStm_State0, STATE_UNDEF );
        WiperTestStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nCurrentState != pStm->base.nPseudostate && IS_IN(pStm->base.nPseudostate, WiperTestStm_WiperTestTop) ){
        WiperTestStm_BgnTrans( pCarBody, pStm, pStm->base.nPseudostate, STATE_UNDEF );
        WiperTestStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else{
    }   }while( FALSE );
    return bResult;
}
static BOOL WiperTestStm_RunToCompletion( CarBody* pCarBody, WiperTestStm* pStm ){
    BOOL bResult;
    do{
        bResult = WiperTestStm_StateDefaultTrans( pCarBody, pStm );
    } while ( bResult );
    return bResult;
}
static int WiperTestStm_IsFinished(WiperTestStm* pWiperTestStm){
    return pWiperTestStm->base.nCurrentState == WiperTestStm_WiperTestTop && pWiperTestStm->base.nCurrentState == pWiperTestStm->base.nPseudostate;
}
static BOOL WiperTestStm_Reset( CarBody* pCarBody, WiperTestStm* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint ) {
    pStm->base.pParentStm = pParentStm;
    if( nEntryPoint == NULL ){
        if( WiperTestStm_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = WiperTestStm_InitialWiperTestStm;
        }
        return FALSE;
    }else{
    if( !IS_IN( nEntryPoint, WiperTestStm_WiperTestTop ) ){ return FALSE; }
        if( WiperTestStm_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = nEntryPoint;
            return FALSE;
        }else{
            pStm->base.nPseudostate = nEntryPoint;
        }
    }
    return TRUE;
}
static BOOL WiperTestStm_EventProc( CarBody* pCarBody, WiperTestStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nLCAState = STATE_UNDEF;
    switch( pStm->base.nCurrentState ){
    case WiperTestStm_State0:                   bResult |= WiperTestStm_State0_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    default: break;
    }
    WiperTestStm_RunToCompletion( pCarBody, pStm );
    return bResult;
}
static BOOL WiperTestStm_IsIn( WiperTestStm* pStm, uint64_t nCompositeState ) {
    if( IS_IN( pStm->base.nCurrentState, nCompositeState ) ){ return TRUE; }
    return FALSE;
}
static BOOL WiperTestStm_Abort( CarBody* pCarBody, WiperTestStm* pStm ) {
    pStm->base.nSourceState = WiperTestStm_WiperTestTop;
    WiperTestStm_BgnTrans( pCarBody, pStm, WiperTestStm_WiperTestTop, STATE_UNDEF );
    WiperTestStm_EndTrans( pCarBody, pStm );
    return TRUE;
}
static void CarStm_BgnTrans( CarBody *pCarTop, CarStm* pStm, uint64_t targetState, uint64_t initState );
static void CarStm_EndTrans( CarBody *pCarTop, CarStm* pStm );
static BOOL CarStm_Reset( CarBody* pCarTop, CarStm* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint );
static BOOL CarStm_Abort( CarBody* pCarTop, CarStm* pStm );
static BOOL CarStm_EventProc( CarBody* pCarTop, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams );
static BOOL CarStm_RunToCompletion( CarBody* pCarTop, CarStm* pStm );
static void CarStm_PowerOn_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_PowerOn ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	-106	81	941	332	-146	-80	1056	518" );
        ImgSprite_setBrightness( powerButton, 1. );
        PowerOn_Region1_Reset( pCarBody, &pStm->PowerOnPowerOn_Region1, &pStm->base, STATE_UNDEF );
    }
}
static BOOL CarStm_PowerOn_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_PowerOn;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	-106	81	941	332	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_E_PWR_BTN:{
        CarStm_BgnTrans( pCarBody, pStm, CarStm_PowerOff, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult;
}
static void CarStm_PowerOn_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_PowerOn ) ){ 
        PowerOn_Region1_Abort( pCarBody, &pStm->PowerOnPowerOn_Region1 );
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	-106	81	941	332	-146	-80	1056	518" );
    }
}
static void CarStm_EngineOn_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_EngineOn ) ){
        CarStm_PowerOn_Entry( pCarBody, pStm );
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	110	113	301	290	-146	-80	1056	518" );
    }
}
static BOOL CarStm_EngineOn_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_EngineOn;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	110	113	301	290	-146	-80	1056	518" );
    return bResult ? bResult : CarStm_PowerOn_EventProc( pCarBody, pStm, nEventId, pEventParams );
}
static void CarStm_EngineOn_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_EngineOn ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	110	113	301	290	-146	-80	1056	518" );
        CarStm_PowerOn_Exit( pCarBody, pStm );
    }
}
static void CarStm_WiperOff_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_WiperOff ) ){
        CarStm_EngineOn_Entry( pCarBody, pStm );
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	198	153	152	64	-146	-80	1056	518" );
        pStm->nEngineOnHistory = CarStm_WiperOff;
    }
}
static BOOL CarStm_WiperOff_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_WiperOff;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	198	153	152	64	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_E_WIPER_LEVER:{
        CarStm_BgnTrans( pCarBody, pStm, CarStm_WiperOn, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult ? bResult : CarStm_EngineOn_EventProc( pCarBody, pStm, nEventId, pEventParams );
}
static void CarStm_WiperOff_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_WiperOff ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	198	153	152	64	-146	-80	1056	518" );
        CarStm_EngineOn_Exit( pCarBody, pStm );
    }
}
static void CarStm_WiperOn_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_WiperOn ) ){
        CarStm_EngineOn_Entry( pCarBody, pStm );
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	198	320	152	64	-146	-80	1056	518" );
        pStm->nEngineOnHistory = CarStm_WiperOn;
    }
}
static BOOL CarStm_WiperOn_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_WiperOn;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	198	320	152	64	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_E_PWR_BTN:{
        CarStm_BgnTrans( pCarBody, pStm, CarStm_PowerOffWait, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    } break;
    case CarBody_E_WIPER_LEVER:{
        CarStm_BgnTrans( pCarBody, pStm, CarStm_WiperOff, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult ? bResult : CarStm_EngineOn_EventProc( pCarBody, pStm, nEventId, pEventParams );
}
static void CarStm_WiperOn_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_WiperOn ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	198	320	152	64	-146	-80	1056	518" );
        CarStm_EngineOn_Exit( pCarBody, pStm );
    }
}
static void CarStm_PowerOffWait_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_PowerOffWait ) ){
        CarStm_PowerOn_Entry( pCarBody, pStm );
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	-96	181	152	64	-146	-80	1056	518" );
    }
}
static BOOL CarStm_PowerOffWait_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_PowerOffWait;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	-96	181	152	64	-146	-80	1056	518" );
    return bResult ? bResult : CarStm_PowerOn_EventProc( pCarBody, pStm, nEventId, pEventParams );
}
static void CarStm_PowerOffWait_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_PowerOffWait ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	-96	181	152	64	-146	-80	1056	518" );
        CarStm_PowerOn_Exit( pCarBody, pStm );
    }
}
static void CarStm_PowerOff_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_PowerOff ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	143	-8	152	64	-146	-80	1056	518" );
        ImgSprite_setBrightness( powerButton, 0.5 );
    }
}
static BOOL CarStm_PowerOff_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_PowerOff;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	143	-8	152	64	-146	-80	1056	518" );
    switch( nEventId ){
    case CarBody_E_PWR_BTN:{
        CarStm_BgnTrans( pCarBody, pStm, CarStm_SubmachineState0, STATE_UNDEF );
        WiperTestStm_Reset( pCarBody, &pStm->SubmachineState0WiperTestStm, &pStm->base, WiperTestStm_EntryPoint0 );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    } break;
    default: break;
    }
    return bResult;
}
static void CarStm_PowerOff_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_PowerOff ) ){ 
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	143	-8	152	64	-146	-80	1056	518" );
    }
}
static void CarStm_SubmachineState0_Entry( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Enterable( &pStm->base, CarStm_SubmachineState0 ) ){
        ObjsBuilder_showEntry( pCarBody, pStm, "Model/CarBody/CarStm	400	-30	145	50	-146	-80	1056	518" );
        WiperTestStm_Reset( pCarBody, &pStm->SubmachineState0WiperTestStm, &pStm->base, STATE_UNDEF );
    }
}
static BOOL CarStm_SubmachineState0_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = CarStm_SubmachineState0;
    ObjsBuilder_showDoing( pCarBody, pStm, "Model/CarBody/CarStm	400	-30	145	50	-146	-80	1056	518" );
    return bResult;
}
static void CarStm_SubmachineState0_Exit( CarBody* pCarBody, CarStm* pStm ){
    if( HdStateMachine_Exitable( &pStm->base, CarStm_SubmachineState0 ) ){ 
        WiperTestStm_Abort( pCarBody, &pStm->SubmachineState0WiperTestStm );
        ObjsBuilder_showExit( pCarBody, pStm, "Model/CarBody/CarStm	400	-30	145	50	-146	-80	1056	518" );
    }
}
static void CarStm_EndTrans( CarBody *pCarBody, CarStm* pStm ){
    pStm->base.nCurrentState = pStm->base.nTargetState;
    pStm->base.bIsExternTrans = FALSE;
    switch( pStm->base.nCurrentState ){
    case CarStm_PowerOn:        CarStm_PowerOn_Entry( pCarBody, pStm ); break;
    case CarStm_EngineOn:       CarStm_EngineOn_Entry( pCarBody, pStm ); break;
    case CarStm_WiperOff:       CarStm_WiperOff_Entry( pCarBody, pStm ); break;
    case CarStm_WiperOn:        CarStm_WiperOn_Entry( pCarBody, pStm ); break;
    case CarStm_PowerOffWait:   CarStm_PowerOffWait_Entry( pCarBody, pStm ); break;
    case CarStm_PowerOff:       CarStm_PowerOff_Entry( pCarBody, pStm ); break;
    case CarStm_SubmachineState0:CarStm_SubmachineState0_Entry( pCarBody, pStm ); break;
    default: break;
    }
}
static void CarStm_BgnTrans( CarBody *pCarBody, CarStm* pStm, uint64_t targetState, uint64_t initState ){
    pStm->base.nTargetState = targetState;
    pStm->base.nPseudostate = targetState;
    if( initState ){
        pStm->base.nPseudostate = initState;
    }
    switch( pStm->base.nCurrentState ){
    case CarStm_PowerOn:        CarStm_PowerOn_Exit( pCarBody, pStm ); break;
    case CarStm_EngineOn:       CarStm_EngineOn_Exit( pCarBody, pStm ); break;
    case CarStm_WiperOff:       CarStm_WiperOff_Exit( pCarBody, pStm ); break;
    case CarStm_WiperOn:        CarStm_WiperOn_Exit( pCarBody, pStm ); break;
    case CarStm_PowerOffWait:   CarStm_PowerOffWait_Exit( pCarBody, pStm ); break;
    case CarStm_PowerOff:       CarStm_PowerOff_Exit( pCarBody, pStm ); break;
    case CarStm_SubmachineState0:CarStm_SubmachineState0_Exit( pCarBody, pStm ); break;
    default: break;
    }
}
static BOOL CarStm_StateDefaultTrans( CarBody* pCarBody, CarStm* pStm ){
    BOOL bResult = FALSE;
    pStm->base.nSourceState = pStm->base.nCurrentState;
    pStm->base.nLCAState = STATE_UNDEF;
    bResult |= PowerOn_Region1_StateDefaultTrans( pCarBody, &pStm->PowerOnPowerOn_Region1 );
    bResult |= WiperTestStm_StateDefaultTrans( pCarBody, &pStm->SubmachineState0WiperTestStm );
    do{   if( pStm->base.nPseudostate == CarStm_InitialPowerOn ){
        if( pStm->nEngineOnHistory && pStm->nEngineOnHistory != CarStm_EngineOn ){
            CarStm_BgnTrans( pCarBody, pStm, pStm->nEngineOnHistory, STATE_UNDEF );
            CarStm_EndTrans( pCarBody, pStm );
            bResult = TRUE;
            break;
        }
        CarStm_BgnTrans( pCarBody, pStm, CarStm_WiperOff, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nPseudostate == CarStm_InitialPseudostate0 ){
        CarStm_BgnTrans( pCarBody, pStm, CarStm_EngineOn, CarStm_InitialPowerOn );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nPseudostate == CarStm_InitialMain ){
        CarStm_BgnTrans( pCarBody, pStm, CarStm_PowerOff, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nCurrentState == CarStm_SubmachineState0 && pStm->base.nPseudostate == WiperTestStm_ExitPoint0 ){
        CarStm_BgnTrans( pCarBody, pStm, CarStm_PowerOn, CarStm_InitialPseudostate0 );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else if( pStm->base.nCurrentState != pStm->base.nPseudostate && IS_IN(pStm->base.nPseudostate, CarStm_CarTop) ){
        CarStm_BgnTrans( pCarBody, pStm, pStm->base.nPseudostate, STATE_UNDEF );
        CarStm_EndTrans( pCarBody, pStm );
        bResult = TRUE;
    }else{
    }   }while( FALSE );
    return bResult;
}
static BOOL CarStm_RunToCompletion( CarBody* pCarBody, CarStm* pStm ){
    BOOL bResult;
    do{
        bResult = CarStm_StateDefaultTrans( pCarBody, pStm );
    } while ( bResult );
    return bResult;
}
static int CarStm_IsFinished(CarStm* pCarStm){
    return pCarStm->base.nCurrentState == CarStm_CarTop && pCarStm->base.nCurrentState == pCarStm->base.nPseudostate;
}
static BOOL CarStm_Reset( CarBody* pCarBody, CarStm* pStm, HdStateMachine* pParentStm, uint64_t nEntryPoint ) {
    pStm->base.pParentStm = pParentStm;
    if( nEntryPoint == NULL ){
        if( CarStm_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = CarStm_InitialMain;
        }
        return FALSE;
    }else{
    if( PowerOn_Region1_Reset( pCarBody, &pStm->PowerOnPowerOn_Region1, &pStm->base, nEntryPoint ) ){ return TRUE; }
    if( WiperTestStm_Reset( pCarBody, &pStm->SubmachineState0WiperTestStm, &pStm->base, nEntryPoint ) ){ return TRUE; }
    if( !IS_IN( nEntryPoint, CarStm_CarTop ) ){ return FALSE; }
        if( CarStm_IsFinished( &pStm->base ) ){
            pStm->base.nPseudostate = nEntryPoint;
            return FALSE;
        }else{
            pStm->base.nPseudostate = nEntryPoint;
        }
    }
    return TRUE;
}
static BOOL CarStm_EventProc( CarBody* pCarBody, CarStm* pStm, CarBody_EVENT nEventId, void* pEventParams ){
    BOOL bResult = FALSE;
    pStm->base.nLCAState = STATE_UNDEF;
    bResult |= PowerOn_Region1_EventProc( pCarBody, &pStm->PowerOnPowerOn_Region1, nEventId, pEventParams );
    bResult |= WiperTestStm_EventProc( pCarBody, &pStm->SubmachineState0WiperTestStm, nEventId, pEventParams );
    switch( pStm->base.nCurrentState ){
    case CarStm_PowerOn:                        bResult |= CarStm_PowerOn_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_EngineOn:                       bResult |= CarStm_EngineOn_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_WiperOff:                       bResult |= CarStm_WiperOff_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_WiperOn:                        bResult |= CarStm_WiperOn_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_PowerOffWait:                   bResult |= CarStm_PowerOffWait_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_PowerOff:                       bResult |= CarStm_PowerOff_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    case CarStm_SubmachineState0:               bResult |= CarStm_SubmachineState0_EventProc( pCarBody, pStm, nEventId, pEventParams ); break;
    default: break;
    }
    CarStm_RunToCompletion( pCarBody, pStm );
    return bResult;
}
static BOOL CarStm_IsIn( CarStm* pStm, uint64_t nCompositeState ) {
if( PowerOn_Region1_IsIn( &pStm->PowerOnPowerOn_Region1, nCompositeState ) ){ return TRUE; }
if( WiperTestStm_IsIn( &pStm->SubmachineState0WiperTestStm, nCompositeState ) ){ return TRUE; }
    if( IS_IN( pStm->base.nCurrentState, nCompositeState ) ){ return TRUE; }
    return FALSE;
}
static BOOL CarStm_Abort( CarBody* pCarBody, CarStm* pStm ) {
    pStm->base.nSourceState = CarStm_CarTop;
    CarStm_BgnTrans( pCarBody, pStm, CarStm_CarTop, STATE_UNDEF );
    CarStm_EndTrans( pCarBody, pStm );
    return TRUE;
}
BOOL CarBody_EventProc( CarBody* pCarBody, CarBody_EVENT nEventId, void* pEventParams ){
    return CarStm_EventProc( pCarBody, &pCarBody->mainStm, nEventId, pEventParams );
}
BOOL CarBody_Start( CarBody* pCarBody ){
    CarStm_Abort( pCarBody, &pCarBody->mainStm );
    CarStm_Reset( pCarBody, &pCarBody->mainStm, NULL, STATE_UNDEF );
    return CarStm_RunToCompletion( pCarBody, &pCarBody->mainStm );
}
BOOL CarBody_Reset( CarBody* pCarBody, uint64_t nEntryPoint ){
    return CarStm_Reset( pCarBody, &pCarBody->mainStm, NULL, nEntryPoint );
}
BOOL CarBody_IsIn( CarBody* pCarBody, uint64_t nState ){
    return CarStm_IsIn( &pCarBody->mainStm, nState );
}
ImgSprite* CarBody_Copy( CarBody* pCarBody, const CarBody* pSource ){
    ImgSprite_Copy( ( ImgSprite* )pCarBody, ( ImgSprite* )pSource );
    pCarBody->x = pSource->x;
    return ( Sprite* )pCarBody;
}
