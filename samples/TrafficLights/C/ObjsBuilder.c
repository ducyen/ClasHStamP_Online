/* File generated by Đức's ClasHStamP */
#define __ObjsBuilder_INTERNAL__
#include "CommonInclude.h"
#include "ObjsBuilder.h"
#include "RedLight.h"                                           
static Sprite g_objects[] = {
    { RedLight_Init(
        P( { 0.16136363636363638, 0.31696134868421055, 0.07954545454545454, 0.10350877192982456 } ),
        P( "../Image/RedLight.png" ),
        P( 10 ),
        P( 10 ),
        P( 0 )) 
    },
    { RedLight_Init(
        P( { 0.7212121212121212, 0.43450520833333334, 0.07954545454545454, 0.10350877192982456 } ),
        P( "../Image/RedLight.png" ),
        P( 10 ),
        P( 10 ),
        P( 0 )) 
    }
};
int ObjsBuilder_startSim(
    void  
){
    SDL_Window *window = NULL;
    SDL_Surface *screenSurface = NULL;
    SDL_Surface *imageSurface = NULL;
    SDL_Surface *transformedSurface = NULL;

    int nResult = S_OK;

    if( nResult == S_OK && SDL_Init(SDL_INIT_VIDEO) < 0 ){
        printf("SDL could not initialize! SDL_Error: %s\n", SDL_GetError());
        nResult == S_FALSE;
    }

    if( nResult == S_OK ){
        // Load image
        imageSurface = IMG_Load("../Image/Design/ObjsBuilder/Main.png");
        if (imageSurface == NULL) {
            printf("Unable to load image! SDL_image Error: %s\n", IMG_GetError());
            nResult = S_FALSE;
        }
    }

    const int SCREEN_WIDTH = imageSurface->w;
    const int SCREEN_HEIGHT = imageSurface->h;
    if( nResult == S_OK ){
        window = SDL_CreateWindow("SDL Tutorial", SDL_WINDOWPOS_UNDEFINED,
                                  SDL_WINDOWPOS_UNDEFINED, SCREEN_WIDTH,
                                  SCREEN_HEIGHT, SDL_WINDOW_SHOWN);
        if (window == NULL) {
            printf("Window could not be created! SDL_Error: %s\n", SDL_GetError());
            nResult = S_FALSE;
        }
    }
    if( nResult == S_OK ){
        screenSurface = SDL_GetWindowSurface(window);
        // Initialize SDL_image
        if (!(IMG_Init(IMG_INIT_PNG) & IMG_INIT_PNG)) {
            printf("SDL_image could not initialize! SDL_image Error: %s\n", IMG_GetError());
            nResult = S_FALSE;
        } 
    }

    for( int i = 0; i < sizeof( g_objects ) / sizeof( g_objects[ 0 ] ) && nResult == S_OK; i++ ){
        if( nResult == S_OK && Sprite_load( &g_objects[ i ] ) == false ){
            nResult = S_FALSE;
        }
    }

    if( nResult == S_OK ){
        bool quit = false;
        SDL_Event e;

        while (!quit) {
            while (SDL_PollEvent(&e) != 0) {
                if (e.type == SDL_QUIT) {
                    quit = true;
                }
            }

            // Clear screen
        #if 1
            SDL_FillRect(screenSurface, NULL, SDL_MapRGB(screenSurface->format, 0xFF, 0xFF, 0xFF));
        #else
            SDL_BlitSurface(imageSurface, NULL, screenSurface, NULL);
        #endif


            for( int i = 0; i < sizeof( g_objects ) / sizeof( g_objects[ 0 ] ) && nResult == S_OK; i++ ){
                Sprite_draw( &g_objects[ i ], screenSurface );
            }
            // Update the surface
            SDL_UpdateWindowSurface(window);

            // Update transformations

            // Delay to control the animation speed
            SDL_Delay(50);
        }
    }

    for( int i = 0; i < sizeof( g_objects ) / sizeof( g_objects[ 0 ] ) && nResult == S_OK; i++ ){
        Sprite_free( &g_objects[ i ] );
    }

    // Free resources and close SDL
    SDL_FreeSurface(imageSurface);
    SDL_DestroyWindow(window);
    IMG_Quit();
    SDL_Quit();

    return 0;

} /* ObjsBuilder_startSim */

ObjsBuilder* ObjsBuilder_Copy( ObjsBuilder* pObjsBuilder, const ObjsBuilder* pSource ){
    return ( ObjsBuilder* )pObjsBuilder;
}
