/* File generated by Đức's ClasHStamP */
#define __ImgSprite_INTERNAL__
#include "CommonInclude.h"
#include "ImgSprite.h"
/** @public @memberof ImgSprite */
static void ImgSprite_draw0(
    ImgSprite* pImgSprite,
    SDL_Renderer* renderer
){
} /* ImgSprite_draw0 */

/** @public @memberof ImgSprite */
static void ImgSprite_draw1(
    ImgSprite* pImgSprite,
    SDL_Renderer* renderer
){
    // Get the size of the renderer
    int width, height;
    if (SDL_GetRendererOutputSize(renderer, &width, &height) != 0) {
        printf("Error getting renderer size: %s\n", SDL_GetError());
    }
    pImgSprite->m_rect = (SDL_Rect){
        pImgSprite->m_iniRect.x * width, 
        pImgSprite->m_iniRect.y * height, 
        pImgSprite->m_iniRect.w * width, 
        pImgSprite->m_iniRect.h * height - 24
    };

    // Set texture color modulation (brightness)
    SDL_SetTextureColorMod(
        pImgSprite->m_image, 
        pImgSprite->m_brightness * 255, 
        pImgSprite->m_brightness * 255, 
        pImgSprite->m_brightness * 255
    );

    // Render the texture
    SDL_RenderCopyEx(renderer, pImgSprite->m_image, NULL, &pImgSprite->m_rect, pImgSprite->m_angle, NULL, SDL_FLIP_NONE);
} /* ImgSprite_draw1 */

/** @public @memberof ImgSprite */
static bool ImgSprite_load(
    ImgSprite* pImgSprite,
    SDL_Renderer* renderer
){
    char sRelPath[ 256 ];
    sprintf( sRelPath, "%s/../%s", getInputDir(), pImgSprite->m_imgPath );
    pImgSprite->m_image = IMG_LoadTexture(renderer, sRelPath);
    if (!pImgSprite->m_image) {
        printf("Failed to load image: %s\n", IMG_GetError());
        return false;
    }
    return true;
} /* ImgSprite_load */

/** @public @memberof ImgSprite */
static void ImgSprite_free(
    ImgSprite* pImgSprite
){
    if (pImgSprite->m_image) {
        SDL_DestroyTexture(pImgSprite->m_image);
    }
} /* ImgSprite_free */

Sprite* ImgSprite_Copy( ImgSprite* pImgSprite, const ImgSprite* pSource ){
    Sprite_Copy( ( Sprite* )pImgSprite, ( Sprite* )pSource );
    return ( Sprite* )pImgSprite;
}
const SpriteVtbl gImgSpriteVtbl = {
    .pdraw0                      = ImgSprite_draw0,
    .pdraw1                      = ImgSprite_draw1,
    .pload                       = ImgSprite_load,
    .pfree                       = ImgSprite_free,
};
